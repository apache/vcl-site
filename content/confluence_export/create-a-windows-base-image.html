<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>


  <link href="/css/vcl.css" rel="stylesheet" type="text/css">
  <link href="/css/code.css" rel="stylesheet" type="text/css">
  <title>Apache VCL - Create a Windows Base Image</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>

<body>
  <div id="sitetitle">
    <table width="100%" border="0" cellspacing="0" cellpadding="5">
      <tr>
         <td><a href="/index.html"><img src="/img/vcl-logo.png" height="100" align="left" alt="Apache VCL logo"></a></td>
         <td><a href="http://www.apache.org"><img src="/img/asf-logo.png" align="right" alt="Apache Software Foundation logo"></a></td>
      </tr>
    </table>
  </div>
  
  <div id="left-column">
    <div id="navigation">
      <ul>
<li><a href="/index.html">Information</a>
<ul>
<li><a href="/info/features.html">Features</a></li>
<li><a href="/info/architecture.html">Architecture</a></li>
<li><a href="/downloads/download.cgi">Download</a></li>
<li><a href="http://www.apache.org/licenses/">License</a></li>
<li><a href="http://www.apache.org/security/">Security</a></li>
</ul>
</li>
<li><a href="/docs/index.html">Documentation</a>
<ul>
<li><a href="https://cwiki.apache.org/confluence/x/yQdG">Using VCL</a></li>
<li><a href="https://cwiki.apache.org/confluence/x/ywdG">Administration</a></li>
<li><a href="/docs/installation.html">Installation</a></li>
</ul>
</li>
<li><a href="https://cwiki.apache.org/confluence/display/VCL/Apache+VCL" target="_blank">Confluence Wiki</a>
  <ul>
      <li></li>
  </ul>
</li>
<li><a href="https://issues.apache.org/jira/browse/VCL" target="_blank">Jira Issue Tracking</a>
  <ul>
      <li></li>
  </ul>
</li>
<li><a href="/comm/index.html">Community</a>
<ul>
<li><a href="/comm/index.html#getInvolved">Getting Involved</a></li>
<li><a href="/comm/index.html#mail-list">Mailing Lists</a></li>
<li><a href="/dev/index.html">Development</a>
<ul>
<li><a href="/dev/code-documentation.html">Code Documentation</a></li>
<li><a href="/dev/roadmap.html">Roadmap</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="http://www.apache.org">Apache Software Foundation</a>
<ul>
<li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
<li><a href="http://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
</ul>
</li>
</ul>
    </div>
    <div id="current-event"> 
      <a  href="https://www.apache.org/events/current-event.html">
        <img src="https://www.apache.org/events/current-event-125x125.png" alt="Apache current event" />
      </a>
    </div>
  </div>
  
  <div id="content">
    <h1 class="title">Create a Windows Base Image</h1>
    
	<p>{excerpt}This page describes how to create a Windows base
image.{excerpt}These instructions should work regardless of the
provisioning engine being used (xCAT, VMware, etc.).  Ignore the
{color:#0000ff}{<em>}VMware Only{</em>}{color} sections if you are attempting
to create an image using xCAT or some other bare metal provisioning
engine. </p>
<p><a name="CreateaWindowsBaseImage-Requirements"></a></p>
<h3 id="requirements">Requirements</h3>
<p>You will need the following:</p>
<ul>
<li>Windows installation ISO file</li>
<li>Windows product key or KMS server address</li>
</ul>
<p> The following must be done before an image can be captured:</p>
<ul>
<li>A computer for the machine being captured has already been added to
the VCL database</li>
<li>{color:#0000ff}{<em>}VMware Only{</em>}{color}:
** A VM host computer on which the guest is running as been added to
the VCL database
** The guest VM has been assigned to the VM host via the <em>Virtual Hosts</em>
link on the VCL website</li>
</ul>
<p>These instructions assume you have root access and are using a <em>bash</em>
shell.</p>
<p><a name="CreateaWindowsBaseImage-{color:#0000ff}VMwareOnly:{color}CreateaVirtualMachine"></a></p>
<h2 id="color0000ffvmware-onlycolor-create-a-virtual-machine">{color:#0000ff}VMware Only:{color} Create a Virtual Machine</h2>
<p><a name="CreateaWindowsBaseImage-CreateaVirtualMachine"></a></p>
<h3 id="create-a-virtual-machine">Create a Virtual Machine</h3>
<p><a name="CreateaWindowsBaseImage-VMwareESXi4.x"></a></p>
<h4 id="vmware-esxi-4x">VMware ESXi 4.x</h4>
<p>The instructions assume that VMware has been configured with the following
bridged networks:</p>
<ul>
<li>
<p><em>Private</em>: bridged to private interface: eth0</p>
</li>
<li>
<p><em>Public</em>: bridged to public interface: eth1</p>
</li>
<li>
<p>Launch the vSphere Client, connect to the ESXi host and login</p>
</li>
<li>
<p>Click File &gt; New &gt; Virtual Machine</p>
</li>
<li>
<p>Configuration: <em>Custom</em></p>
</li>
<li>
<p>Name: <em>(doesn&rsquo;t matter)</em></p>
</li>
<li>
<p>Select a datastore where the VM will reside</p>
</li>
<li>
<p>Virtual Machine Version: <em>7</em></p>
</li>
<li>
<p>Select the appropriate guest OS</p>
</li>
<li>
<p>Number of virtual processors: 1</p>
</li>
<li>
<p>Memory: 1GB</p>
</li>
<li>
<p>How many NICs: 2
** NIC 1: <em>Private</em>, E1000
** NIC 2: <em>Public</em>, E1000</p>
</li>
<li>
<p>SCSI controller: LSI Logic Parallel</p>
</li>
<li>
<p>Create a new virtual disk
** Disk Size: at least 30 GB
** Allocate and commit space on demand (Thin Provisioning): <em>Yes</em>
** Location: Store with the virtual machine
** Virtual Device Node: SCSI (0:0)
** Mode: Independent, Persistent</p>
</li>
<li>
<p>Edit the virtual machine settings before completion: <em>Yes</em></p>
</li>
<li>
<p>Select the CD/DVD device
** Device Type: <em>Datastore ISO File</em>
** Click Browse and browse to an ISO file that has previously been copied
to the datastore
** Connect at power on: <em>Yes</em></p>
</li>
<li>
<p>Click Finish</p>
</li>
</ul>
<p><a name="CreateaWindowsBaseImage-VMwareServer1.x"></a></p>
<h4 id="vmware-server-1x">VMware Server 1.x</h4>
<p>The instructions assume that VMware has been configured with the following
bridged networks:</p>
<ul>
<li>
<p>VMnet0: bridged to private interface: eth0</p>
</li>
<li>
<p>VMnet2: bridged to public interface: eth1</p>
</li>
<li>
<p>Launch the VMware Server console and connect to the local VMware host:
{tip}
vmware &amp;
{tip}</p>
</li>
<li>
<p>Virtual Machine Configuration: <em>Typical</em></p>
</li>
<li>
<p>Guest Operating System: <em>Microsoft Windows</em></p>
</li>
<li>
<p>Version: <em>Windows XP Professional</em> (select the appropriate version if you
are not installing XP)</p>
</li>
<li>
<p>Name: <em>vmwarewinxp-base7-v1</em></p>
</li>
<li>
<p>Network connection: <em>Custom</em>
** /dev/vmnet0*</p>
</li>
<li>
<p>Disk size: <em>8.0 GB</em>
** Allocate all disk space now: <em>no</em>
** Split disk into 2GB files: <em>yes</em></p>
</li>
<li>
<p>Edit virtual machine settings
** Configure the VM CD-ROM drive to use the Windows XP ISO image
** Connection: <em>Use ISO image</em>: browse to path of Windows XP ISO image
copied to the VMware host</p>
</li>
<li>
<p>Add: Ethernet Adapter
** Network Connection: <em>Custom</em>
** */dev/vmnet2*</p>
</li>
</ul>
<p><a name="CreateaWindowsBaseImage-VMwareServer2.x"></a></p>
<h4 id="vmware-server-2x">VMware Server 2.x</h4>
<ul>
<li>Open the VMware Infrastructure Web Access page:
{info:icon=false}https://<IP address or hostname>:8333{info}</li>
<li>Click the <em>Virtual Machine</em> menu</li>
<li>Select <em>Create Virtual Machine</em></li>
<li>Name and Location
** Name: <em>Windows XP Base</em>
** Datastore: <em>standard</em> (This causes the VM to be created under
/var/lib/vmware/Virtual Machines)</li>
<li>Guest Operating System
** Operating System: <em>Windows operating system</em>
** Version: <em>Microsoft Windows XP Professional (32-bit)</em>
** Product Compatibility: <em>4</em> (Optional - the hardware version can be set
to the default value of <em>7</em> if you do not have any older VMware Server 1.x
hosts in your environment)</li>
<li>Memory and Processors
** Memory Size: <em>1024 MB</em>
** Processor Count: <em>1</em></li>
<li>Hard Disk
** Click <em>Create a New Virtual</em>
*** Capacity: at least <em>20 GB</em> (This value can be adjusted to suit the size
of the VMware host&rsquo;s disk. It is best to create the base image with a large
enough hard drive to accomodate your largest image. The hard drive of a VM
can be expanded but it is a manual, time-consuming process.)
*** File Options
**** Allocate all disk space now: no
**** Split disk into 2 GB files: yes
*** Disk Mode: <em>Independent/Persistent</em></li>
<li>Network Adapter
** Click <em>Add a Network Adapter</em>
*** Network Connection: select the name of your <em>private</em> network</li>
<li>CD/DVD Drive
** Click <em>Use an ISO</em>
*** Select the Windows ISO image you copied to the host. The ISO file must
reside in <em>/var/lib/vmware/Virtual Machines</em> in order to be able to select
it from this interface.</li>
<li>Don&rsquo;t Add a Floppy Drive</li>
<li>Don&rsquo;t Add a USB</li>
<li>Click <em>Finish</em></li>
<li>Select the VM from the Inventory pane</li>
<li>Click <em>Add Hardware</em> on the right side of the page</li>
<li>Select <em>Network Adapter</em>
** Network Connection: select the name of your <em>public</em> network</li>
<li>Click <em>Next</em> &gt; <em>Finish</em></li>
</ul>
<p><a name="CreateaWindowsBaseImage-InstallWindows"></a></p>
<h2 id="install-windows">Install Windows</h2>
<p><a href="install-windows-for-a-base-image.html">Install Windows for a Base Image</a></p>
<p><a name="CreateaWindowsBaseImage-{color:#0000ff}VMwareOnly:{color}InstallVMwareTools"></a></p>
<h2 id="color0000ffvmware-onlycolor-install-vmware-tools">{color:#0000ff}VMware Only:{color} Install VMware Tools</h2>
<ol>
<li>Power on the VM if it is not already powered on</li>
<li>Install VMWare Tools  (Note: you must have a CD-ROM drive configured
for the VM in order to install VMware Tools)</li>
<li>
<h1 id="click-on-the-vm-menu-and-select-install-vmware-tools">Click on the VM menu and select &ldquo;Install VMWare Tools&rdquo;</h1>
</li>
<li>
<h1 id="select-typical-and-proceed-through-the-setup-pages-accepting-the">Select Typical and proceed through the setup pages accepting the</h1>
</li>
</ol>
<p>defaults</p>
<ol>
<li>
<h1 id="reboot-the-vm-when-installation-is-complete">Reboot the VM when installation is complete</h1>
</li>
</ol>
<p><a name="CreateaWindowsBaseImage-InstallCygwinSSHD"></a></p>
<h2 id="install-cygwin-sshd">Install Cygwin SSHD</h2>
<p>Follow the steps: <a href="install-&amp;-configure-cygwin-sshd.html">Install &amp; Configure Cygwin SSHD</a></p>
<p>{include:Capture A Base Image}</p>


  </div>
  
  <div id="footer">
    <div class="copyright">
      <p>
        Copyright &copy; 2020 The Apache Software Foundation, Licensed under
        the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.
        <br />
        Apache and the Apache feather logo are trademarks of The Apache Software Foundation.
      </p>
    </div>
  </div>
  
</body>
</html>
