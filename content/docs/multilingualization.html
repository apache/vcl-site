<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>


  <link href="/css/vcl.css" rel="stylesheet" type="text/css">
  <link href="/css/code.css" rel="stylesheet" type="text/css">
  <title>Apache VCL - Adding a New Locale to the VCL Web Frontend</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>

<body>
  <div id="sitetitle">
    <table width="100%" border="0" cellspacing="0" cellpadding="5">
      <tr>
         <td><a href="/index.html"><img src="/img/vcl-logo.png" height="100" align="left" alt="Apache VCL logo"></a></td>
         <td><a href="http://www.apache.org"><img src="/img/asf-logo.png" align="right" alt="Apache Software Foundation logo"></a></td>
      </tr>
    </table>
  </div>
  
  <div id="left-column">
    <div id="navigation">
      <ul>
<li><a href="/index.html">Information</a>
<ul>
<li><a href="/info/features.html">Features</a></li>
<li><a href="/info/architecture.html">Architecture</a></li>
<li><a href="/downloads/download.cgi">Download</a></li>
<li><a href="http://www.apache.org/licenses/">License</a></li>
<li><a href="http://www.apache.org/security/">Security</a></li>
</ul>
</li>
<li><a href="/docs/index.html">Documentation</a>
<ul>
<li><a href="https://cwiki.apache.org/confluence/x/yQdG">Using VCL</a></li>
<li><a href="https://cwiki.apache.org/confluence/x/ywdG">Administration</a></li>
<li><a href="/docs/installation.html">Installation</a></li>
</ul>
</li>
<li><a href="https://cwiki.apache.org/confluence/display/VCL/Apache+VCL" target="_blank">Confluence Wiki</a>
  <ul>
      <li></li>
  </ul>
</li>
<li><a href="https://issues.apache.org/jira/browse/VCL" target="_blank">Jira Issue Tracking</a>
  <ul>
      <li></li>
  </ul>
</li>
<li><a href="/comm/index.html">Community</a>
<ul>
<li><a href="/comm/index.html#getInvolved">Getting Involved</a></li>
<li><a href="/comm/index.html#mail-list">Mailing Lists</a></li>
<li><a href="/dev/index.html">Development</a>
<ul>
<li><a href="/dev/code-documentation.html">Code Documentation</a></li>
<li><a href="/dev/roadmap.html">Roadmap</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="http://www.apache.org">Apache Software Foundation</a>
<ul>
<li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
<li><a href="http://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
</ul>
</li>
</ul>
    </div>
    <div id="current-event"> 
      <a  href="https://www.apache.org/events/current-event.html">
        <img src="https://www.apache.org/events/current-event-125x125.png" alt="Apache current event" />
      </a>
    </div>
  </div>
  
  <div id="content">
    <h1 class="title">Adding a New Locale to the VCL Web Frontend</h1>
    
	<h2 id="introduction">Introduction</h2>
<p>VCL 2.3 has the first step in multilingualization by allowing the parts of the site
that the basic user sees to be presented in different languages. The initial work was
done and contributed by Toru Yokoyama in JIRA-485.</p>
<p>More work will be done in future releases to add multilingualization to all parts of
the site. Also, there are currently several sections where a paragraph may be
translated in portions instead of as a whole. This does not provide for optimal
translations. This should be addressed if future releases.</p>
<p>There are three places where translation work needs to happen to add a new language:
a gettext translation file (.po or portable object file), a javascript translation
file, and a few database entries.</p>
<h2 id="places-to-translate">Places to translate</h2>
<p>There are two files to work with - a php translation file and a javascript translation
file. Also, there are entries that need to be added to the database in the connect
method table.</p>
<pre><code>vcl/locale/po_files/vcl.po.template
vcl/js/nls/messages.js.template
</code></pre>
<h2 id="creating-a-gettext-translation-file">Creating a gettext translation file</h2>
<p>vcl/locale/po_files/vcl.po.template is a base translation file. You need to create
two new directories under vcl/locale for your new locale (using es_PR as an example):</p>
<pre><code>vcl/locale/es_PR/LC_MESSAGES
vcl/locale/po_files/es_PR
</code></pre>
<p>Next, create a file named language in the new locale directory (vcl/locale/es_PR)
with the name you would like displayed in the drop-down box for selecting the locale:</p>
<pre><code>echo 'Spanish (PR)' &gt; vcl/locale/es_PR/language
</code></pre>
<p>Next, copy vcl/locale/po_files/vcl.po.template under the new po path:</p>
<pre><code>cp vcl/locale/po_files/vcl.po.template vcl/locale/po_files/es_PR/vcl.po
</code></pre>
<p>You need to translate each string in your new vcl.po file in to the new language. The
file has pairs of lines like</p>
<pre><code>msgid &quot;&lt;H2&gt;Welcome to the Virtual Computing Lab&lt;/H2&gt;\n&quot;
msgstr &quot;&quot;
</code></pre>
<p>You must translate the string listed after msgid and place the translation on the
msgstr line. There is a program under Linux named poedit from the gettext suite that
makes this easier. Make sure you incorporate any HTML in the string into your
translated string.</p>
<p>After you have translated everything, you need to compile the .po file into a .mo
file using msgfmt, also from the gettext suite, placing the .mo file under the
vcl/locale/es_PR/LC_MESSAGES/ path:</p>
<pre><code>msgfmt --output=vcl/locale/es_PR/LC_MESSAGES/vcl.mo vcl/locale/po_files/es_PR/vcl.po
</code></pre>
<h2 id="creating-a-javascript-translation-file">Creating a javascript translation file</h2>
<p>There is a base translation file at vcl/js/nls/messages.js.template. You need to create a new directory under vcl/js/nls (using es_PR as an example):</p>
<pre><code>vcl/js/nls/es_PR
</code></pre>
<p>Next, copy vcl/js/nls/messages.js.template under the new nls path:</p>
<pre><code>cp vcl/js/nls/messages.js.template vcl/js/nls/messages.js
</code></pre>
<p>You need to translate each string in your new messages.js file in to the new
language. The file has an English string and a translation string on each line line:</p>
<pre><code>'Times cannot be suggested for cluster reservations': '',
</code></pre>
<p>You must translate the string in the first set of quotes and place the translation
in the second set of quotes for each string in the file.</p>
<h2 id="adding-entries-to-connectmethod-table-in-database">Adding entries to connectmethod table in database</h2>
<p>VCL 2.3 also introduced Connection Methods. This actually introduced a problem with
multilingualization because most of the text for the Connect page is now in the
database. Each connect method has a description and the text to be displayed on the
Connect page. These are in the connectmethod.description and connectmethod.connecttext
fields. If you will only need a single language for your site, you can just change the
text in those fields to be in your desired language. If you will need multiple
languages, you can add additional fields to the table for each locale. You need to
add two fields for each locale (using es_PR as an example):</p>
<pre><code>connectmethod.description_es_PR
connectmethod.connecttext_es_PR
</code></pre>
<p>You can add as many of the pairs of fields to the database as needed. The VCL code
will check for the existance of fields with names like the above, and automatically
display the text from the correct one if it exists. If it does not, the content of
connectmethod.description and connectmethod.connecttext will be used.</p>


  </div>
  
  <div id="footer">
    <div class="copyright">
      <p>
        Copyright &copy; 2020 The Apache Software Foundation, Licensed under
        the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.
        <br />
        Apache and the Apache feather logo are trademarks of The Apache Software Foundation.
      </p>
    </div>
  </div>
  
</body>
</html>
