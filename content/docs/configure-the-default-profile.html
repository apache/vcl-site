<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>


  <link href="/css/vcl.css" rel="stylesheet" type="text/css">
  <link href="/css/code.css" rel="stylesheet" type="text/css">
  <title>Apache VCL - Configure the Default Profile</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
</head>

<body>
  <div id="sitetitle">
    <table width="100%" border="0" cellspacing="0" cellpadding="5">
      <tr>
         <td><a href="/index.html"><img src="/img/vcl-logo.png" height="100" align="left" alt="Apache VCL logo"></a></td>
         <td><a href="http://www.apache.org"><img src="/img/asf-logo.png" align="right" alt="Apache Software Foundation logo"></a></td>
      </tr>
    </table>
  </div>
  
  <div id="left-column">
    <div id="navigation">
      <ul>
<li><a href="/index.html">Information</a>
<ul>
<li><a href="/info/features.html">Features</a></li>
<li><a href="/info/architecture.html">Architecture</a></li>
<li><a href="/downloads/download.cgi">Download</a></li>
<li><a href="http://www.apache.org/licenses/">License</a></li>
<li><a href="http://www.apache.org/security/">Security</a></li>
</ul>
</li>
<li><a href="/docs/index.html">Documentation</a>
<ul>
<li><a href="https://cwiki.apache.org/confluence/x/yQdG">Using VCL</a></li>
<li><a href="https://cwiki.apache.org/confluence/x/ywdG">Administration</a></li>
<li><a href="/docs/installation.html">Installation</a></li>
</ul>
</li>
<li><a href="https://cwiki.apache.org/confluence/display/VCL/Apache+VCL" target="_blank">Confluence Wiki</a>
  <ul>
      <li></li>
  </ul>
</li>
<li><a href="https://issues.apache.org/jira/browse/VCL" target="_blank">Jira Issue Tracking</a>
  <ul>
      <li></li>
  </ul>
</li>
<li><a href="/comm/index.html">Community</a>
<ul>
<li><a href="/comm/index.html#getInvolved">Getting Involved</a></li>
<li><a href="/comm/index.html#mail-list">Mailing Lists</a></li>
<li><a href="/dev/index.html">Development</a>
<ul>
<li><a href="/dev/code-documentation.html">Code Documentation</a></li>
<li><a href="/dev/roadmap.html">Roadmap</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="http://www.apache.org">Apache Software Foundation</a>
<ul>
<li><a href="http://www.apache.org/foundation/thanks.html">Thanks</a></li>
<li><a href="http://www.apache.org/foundation/sponsorship.html">Sponsorship</a></li>
</ul>
</li>
</ul>
    </div>
    <div id="current-event"> 
      <a  href="https://www.apache.org/events/current-event.html">
        <img src="https://www.apache.org/events/current-event-125x125.png" alt="Apache current event" />
      </a>
    </div>
  </div>
  
  <div id="content">
    <h1 class="title">Configure the Default Profile</h1>
    
	<p>A Windows profile is the desktop environment configured for a
particular user. It contains various settings such as desktop colors,
backgrounds, icon placement, and Windows Explorer settings. The default
profile is a template profile that is used when a user logs on to a Windows
computer for the first time. The default profile can be customized by the
image creator.</p>
<h1 id="windows-xp-and-windows-server-2003">Windows XP and Windows Server 2003</h1>
<h3 id="create-a-profile-configuration-account">Create a profile configuration account:</h3>
<ol>
<li>While logged on as <strong>Administrator</strong>, create a local Windows user account
named <strong>VCLProfile</strong> and add it to the <strong>Administrators</strong> group</li>
<li>Configure the profile:
 <ol type="a">
 <li>Log on as **VCLProfile**
 <li>Make desired profile, desktop, and application changes
 <li>Log out<br/>
 **NOTE**: If you just disconnect but do not log out, 
 you will not be able to complete step 7 below.
 </ol>
</li>
</ol>
<h3 id="copy-the-profile-to-default-user">Copy the profile to &ldquo;Default User&rdquo;:</h3>
<ol>
<li>Log back on as <strong>Administrator</strong></li>
<li>Rename the <strong>C:\Documents and Settings\Default User</strong> directory to
something like <strong>Default User Original</strong></li>
<li>Open the <strong>Control Panel</strong></li>
<li>Open <strong>System Properties</strong></li>
<li>Select the <strong>Advanced</strong> tab</li>
<li>Click the <strong>Settings</strong> button next to User Profiles</li>
<li>Select VCLProfile&rsquo;s profile, click <strong>Copy To</strong> :
Copy profile to: <strong>C:\Documents and Settings\Default User</strong>
Permitted to use: add the <strong>Everyone</strong> group</li>
<li>Click <strong>OK</strong></li>
</ol>
<h3 id="clean-up-the-profile-configuration-account">Clean up the profile configuration account:</h3>
<ol>
<li>Delete the <strong>VCLProfile</strong> user</li>
<li>Delete <strong>C:\Documents and Settings\VCLProfile</strong></li>
</ol>
<p>You can then create another account and log in using it to make sure your
profile settings take affect for new users. Be sure to delete it once
you&rsquo;re done testing.</p>
<h1 id="windows-7-and-windows-server-2008">Windows 7 and Windows Server 2008</h1>
<p>Microsoft does not support copying profiles under Windows 7 and Windows
Server 2008.  The &ldquo;Copy To&rdquo; button is grayed out for all profiles except
the default profile.  The only supported method is built into Sysprep and
this method is itself very problematic.  The following steps are not
supported or recommended by Microsoft but seem to work:</p>
<h3 id="allow-desktop-backgrounds">Allow Desktop Backgrounds</h3>
<ol>
<li>Download and edit the RDP file for your imaging reservation from the VCL
website to allow desktop backgrounds or else you won’t be able to change
the desktop background color
 <ol type="a">
 <li>Right-click on the .rdp file and select *Edit*
 <li>Click on the *Experience* tab&nbsp;
 <li>*Enable* the checkbox next to *Desktop background*
 <li>Click on the *General* tab
 <li>Click *Save*
 </ol>
</li>
<li>Login as Administrator</li>
<li>Configure Windows Explorer to show hidden and system file
 <ol type="a">
 <li>Open *Windows Explorer*
 <li>Click *Organize > Folder and search options*
 <li>Select the *View* tab
 <li>Select the radio button next to *Show hidden files, folders, and drives*
 <li>Click *OK*
 </ol>
</li>
</ol>
<h3 id="create-a-profile-configuration-account-1">Create a profile configuration account:</h3>
<ol>
<li>Create a new local user account named Profile
 <ol type="a">
 <li>Open **Control Panel > Add or remove user accounts**
 <li>If there is already an account named **VCLProfile** and you want to start
</li>
</ol>
<p>over with a new account, delete the existing account and then create a new one:
<ol type="i">
<li>Click on the <strong>VCLProfile</strong> user
<li>Click <strong>Delete the account</strong>
<li>Click <strong>Delete Files</strong>
<li>Click <strong>Delete Account</strong>
</ol>
<li>Click <strong>Create a new account</strong>
<li>Enter the account name: <strong>VCLProfile</strong>
<li>Click the radio button next to <strong>Administrator</strong>
<li>Click <strong>Create Account</strong>
</ol></p>
<ol>
<li>Set the password for the VCLProfile account
 <ol type="a">
 <li>Click on the VCLProfile account
 <li>Click **Create a password**
 <li>Enter the password and click **Create password**
 </ol>
</li>
<li>Configure the user profile for the VCLProfile account
 <ol type="a">
 <li>Logout as Administrator and login as VCLProfile
 <li>Customize the user profile for the VCLProfile account
 <li>Logout as VCLProfile
 </ol>
</li>
</ol>
<h3 id="copy-the-profile-to-default">Copy the profile to &ldquo;Default&rdquo;:</h3>
<ol>
<li>Rename the <strong>VCLProfile</strong> user profile folder to <strong>Default</strong>
 <ol type="a">
 <li>Login as Administrator
 <li>Open a Windows Explorer window and navigate to **C:\Users**
 <li>Rename the original default profile folder: C:\Users\\**Default** ->
</li>
</ol>
<p>C:\Users\<strong>Default Original</strong></p>
<ol>
<li>
<p>Rename the customized profile folder: C:\Users\<strong>VCLProfile</strong> -&gt;
C:\Users\<strong>Default</strong><br/>
<em>Note: if you are unable to rename the VCLProfile folder, reboot the computer,
login as Administrator, and try again.	Run the following command from a
command prompt to reboot the computer:</em></p>
<pre><code> shutdown.exe -r -f -t 0
</code></pre>
 </ol>
</li>
<li>
<p>Copy the customized profile folder using the Windows profile copying
utility<br/>
<em>Note: Windows 7 only allows its built-in profile copying utility to be
used to copy the default profile, not profiles of other user accounts. The
profile you customized now resides in the default profile location
(C:\Users\Default) so the utility can now be used to make a copy of it.</em></p>
 <ol type="a">
 <li>Open **Control Panel > System and Security > System**
 <li>Click **Advanced system settings** on the left
 <li>Click the **Settings...** button under User Profiles
 <li>Highlight **Default Profile**
 <li>Click **Copy To…**
     <ol type="i">
     <li>Copy profile to: **C:\Users\Default Copy**
     <li>Click **Change** under Permitted to use
     <li>Enter **Everyone** and click OK
     <li>Click OK
     </ol>
 </ol>
</li>
<li>
<p>Replace the original customized profile directory with the one created by
the Windows profile copying utility<br/>
<em>Note: C:\Users\Default contains the original customized profile.  The same
profile also resides in C:\Users\Default Copy.	The Default Copy folder is
the one which has had the Windows profile copying utility transformations
applied to it.</em></p>
 <ol type="a">
 <li>Open **Windows Explorer**
 <li>Delete the C:\Users\\**Default** folder
 <li>Rename the folder: C:\Users\\**Default Copy** -> C:\Users\\**Default**
 </ol>
</li>
<li>
<p>Delete the VCLProfile account</p>
 <ol type="a">
 <li>Open **Control Panel > Add or remove user accounts**
 <li>Click on the **VCLProfile** account
 <li>Click **Delete the account**
 <li>Click **Delete Files**
 <li>Click **Delete Account**
 </ol>
</li>
</ol>
<p>Any new local user accounts created on the computer should receive a user
profile configured with the customizations you made to the VCLProfile account.</p>
<h2 id="how-to-force-the-desktop-background-to-appear-on-windows-7--windows-server-2008">How to Force the Desktop Background to Appear on Windows 7 &amp; Windows Server 2008</h2>
<ol>
<li>Run <strong>gpedit.msc</strong></li>
<li>Navigate to <strong>User Configuration &gt; Scripts</strong></li>
<li>Double-click <strong>Logon</strong></li>
<li>Click <strong>Add</strong>
 <ol type="a">
 <li>Script Name: reg.exe
 <li>Script Parameters: **DELETE "HKCU\Remote\1\Control Panel\Desktop" /v 
</li>
</ol>
<p>Wallpaper /f**
</ol></p>
<ol>
<li>Click <strong>OK</strong></li>
<li>Run <strong>gpupdate.exe /force</strong></li>
</ol>


  </div>
  
  <div id="footer">
    <div class="copyright">
      <p>
        Copyright &copy; 2020 The Apache Software Foundation, Licensed under
        the <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.
        <br />
        Apache and the Apache feather logo are trademarks of The Apache Software Foundation.
      </p>
    </div>
  </div>
  
</body>
</html>
